---
id: "26.13-wave4-planner-guardrails-and-constitution"
title: "Plan Mode governance: PLANNER guardrails (read-only outside .project/*) + reusable includes"
type: docs
owner:
session_id:
parent_id:
child_ids:
depends_on:
  - "002-prompts-constitutions-compaction"
  - "26.9-wave4-slash-commands-and-start-plan-mode"
  - "26.12-wave4-plan-analysis-and-correct-course"
  - "26.14-wave4-plan-tasks-sync-and-drift-management"
  - "029-task-codebase-coherence-audit"
blocks_tasks:
related:
  - "26.10-wave4-docs-guidelines-and-migrations"
claimed_at:
last_active:
continuation_id:
created_at: "2025-12-31T00:00:00Z"
updated_at: "2025-12-31T00:00:00Z"
tags:
  - plan-mode
  - prompts
  - constitutions
  - guidelines
priority: high
estimated_hours:
model:
---

# Plan Mode governance: PLANNER guardrails (read-only outside .project/*) + reusable includes

## Summary

Formalize Plan Mode governance so “planning” sessions are safe and predictable:
- Planning is read-only outside Edison-managed planning artifacts.
- Planner outputs must be structured and approval-gated.
- These constraints must survive context compaction (constitution/include-based).

This task implements a “PLANNER” rule set as reusable includes that:
- can be embedded into the ORCHESTRATOR constitution (durable)
- can be embedded into Plan Mode start prompt and plan-related slash commands (bootstrap + consistent UX)

## Required Reading

- Prompt/constitution DRY rules: `docs/PROMPT_DEVELOPMENT.md`
- Compaction durability task: `.project/tasks/todo/002-prompts-constitutions-compaction.md`
- Plan Mode canonical doc: `.project/plans/plan-1-plan-mode.md`
- Optional vendor references (if available; do not block if missing):
  - Spec‑Kit constitution/plan guardrails patterns:
    - `spec-kit/templates/commands/constitution.md`
    - `spec-kit/templates/commands/plan.md`

## Objectives

- [ ] Create a single canonical include-only file for Plan Mode governance (planner guardrails), e.g.:
  - `src/edison/data/guidelines/includes/PLANNER_GUARDRAILS.md`
- [ ] The include must specify:
  - Allowed write scope in Plan Mode: `.project/plans/**`, `.project/tasks/**`, `.project/qa/**` (and `.project/logs/**` if needed)
  - Forbidden changes until approval: no `src/**`, no config, no templates, no generated IDE outputs
  - Required grounding steps: run deterministic audits first (`task audit`, `task waves`, and later `plan validate`)
  - Approval gating: edits require explicit approval; prefer minimal diffs
  - Halt conditions: stop if prerequisites are missing or plan/task state invalid
- [ ] The include MUST be structured for reuse (no duplication), with at least:
  - a durable section intended for constitutions (compaction-safe)
  - a shorter bootstrap section intended for start prompts
  - explicit “Allowed writes / Forbidden writes” bullets that are unambiguous
- [ ] Ensure ORCHESTRATOR constitution includes the durable planner guardrails (compaction safe), via include-only section (no duplication).
- [ ] Ensure Plan Mode start prompt (`START_PLAN_MODE`) includes the bootstrap portion and points to the constitution/include for full rules.
- [ ] Ensure all plan-related slash commands reference the planner guardrails include (consistency).

## Acceptance Criteria

- [ ] There is exactly one canonical planner guardrails include file; content is not duplicated across prompts.
- [ ] Post-compaction, re-reading ORCHESTRATOR constitution restores Plan Mode governance.
- [ ] Plan Mode prompts/commands consistently enforce “read-only outside .project/*” until approved.

## Files to Create/Modify

```
# Add
src/edison/data/guidelines/includes/PLANNER_GUARDRAILS.md

# Modify
src/edison/data/start/START_PLAN_MODE.md
src/edison/data/commands/plan/plan-mode.md
src/edison/data/commands/plan/plan-allocate-id.md
src/edison/data/commands/plan/plan-new.md
src/edison/data/commands/plan/plan-list.md
src/edison/data/commands/plan/plan-show.md
src/edison/data/commands/plan/plan-validate.md
src/edison/data/commands/plan/plan-approve.md
src/edison/data/commands/plan/plan-generate-tasks.md
src/edison/data/commands/plan/plan-tasks.md
src/edison/data/commands/plan/plan-analyze.md
src/edison/data/commands/plan/plan-correct-course.md
src/edison/data/commands/plan/plan-sync-tasks.md
src/edison/data/commands/plan/plan-refine.md
src/edison/data/commands/plan/plan-codebase-coherence.md
```
