---
id: "26.1-wave1-meta-share-plans"
title: "Meta-share .project/plans in worktree mode (commit-allowed)"
type: feature
owner:
session_id:
parent_id:
child_ids:
depends_on: []
blocks_tasks:
related: []
claimed_at:
last_active:
continuation_id:
created_at: "2025-12-28T00:00:00Z"
updated_at: "2025-12-28T00:00:00Z"
tags:
  - plan-mode
  - worktrees
priority: high
estimated_hours:
model:
---

# Meta-share .project/plans in worktree mode (commit-allowed)

## Summary

Ensure `.project/plans` behaves like Edisonâ€™s other project-management artifacts under worktrees: it must be shared via the meta worktree when `worktrees.sharedState.mode: meta`, and commits to plan files must be allowed by the meta commit guard.

This is a prerequisite for Plan Mode because plans are Edison-managed artifacts that must remain consistent across session worktrees.

## Required Reading

- `.project/plans/plan-1-plan-mode.md`
- `src/edison/data/config/worktrees.yaml` (sharedPaths + commit guard behavior)
- `src/edison/core/session/worktree/manager.py` (`_ensure_meta_commit_guard`)

## Objectives

- [ ] Add `.project/plans` to the default `worktrees.sharedState.sharedPaths` list.
- [ ] Ensure `commitAllowed: true` so the meta commit guard permits it (derived allow-prefix).
- [ ] Add tests that verify `.project/plans` is included and commit-allowed when composing defaults.

## Acceptance Criteria

- [ ] `src/edison/data/config/worktrees.yaml` includes a `sharedPaths` entry for `.project/plans` with:
  - `scopes: ["primary","session"]`
  - `commitAllowed: true`
- [ ] Worktree meta commit guard allowlist includes `.project/plans/` implicitly (derived from sharedPaths).
- [ ] Tests cover the new shared path and ensure regression protection.

## Technical Design

1) Update config:
   - `src/edison/data/config/worktrees.yaml`:
     - Add `- path: ".project/plans"` near other `.project/*` entries.
     - Mark `commitAllowed: true`.
2) Add/extend tests:
   - Prefer updating existing worktree tests verifying shared paths and commit guard allow prefixes.
   - Assert `.project/plans` appears in computed allow prefixes when meta guard is enabled.

## Files to Create/Modify

```
# Modify
src/edison/data/config/worktrees.yaml
tests/unit/session/worktree/test_session_worktree.py
```

## Verification

- [ ] Run unit tests for worktree manager / config
- [ ] Quick manual sanity: create session worktree and confirm `.project/plans` is symlinked into session
