[pytest]
# Pytest configuration for E2E workflow tests

# Test discovery
python_files = test_*.py
python_classes = Test*
python_functions = test_*
# Exclude helper modules from test collection
norecursedirs = helpers

# Output options
addopts =
    -v
    --tb=short
    --strict-markers
    --color=yes
    --import-mode=importlib

# Markers
markers =
    # Test Categories
    integration: marks integration tests (multiple components working together)
    e2e: marks end-to-end tests (full system tests)
    golden_path: marks golden-path example tests showing correct patterns
    scenario: marks high-level scenario coverage tests
    edge_case: marks edge case and error handling tests

    # Speed/Performance
    slow: marks tests as slow (deselect with '-m "not slow"') - tests taking >2 seconds
    fast: marks tests as fast (select with '-m fast')

    # Requirements
    requires_git: marks tests that require git operations and git to be installed
    requires_subprocess: marks tests that spawn subprocesses
    requires_pnpm: marks tests that require pnpm/node

    # Feature Areas
    worktree: marks tests related to git worktree functionality
    session: marks tests related to session management
    task: marks tests related to task lifecycle
    qa: marks tests related to QA/validation
    context7: marks tests related to Context7 enforcement
    taskstate: marks tests that validate task state coverage

    # Validation Types
    guards: marks tests focused on guard and state-machine validation
    bundle: marks bundle/aggregate validation tests
    security: marks tests focused on security and invariant enforcement

# Test paths
# Use .edison/core/tests as the single pytest root
testpaths = .

# Coverage options (if using pytest-cov)
[coverage:run]
# Use repo root as coverage source from this location
source = ../../..
omit =
    */tests/*
    */test_*
    */__pycache__/*

[coverage:report]
precision = 2
show_missing = True
skip_covered = False
