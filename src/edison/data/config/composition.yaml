# Composition system configuration
# Controls prompt composition, orchestrator manifests, and agent assembly

composition:
  generatedFileHeader: |
    <!-- 
      AUTO-GENERATED FILE - DO NOT EDIT MANUALLY
      Generated by: Edison Framework v{{version}}
      Template: {{template_name}}
      Generated at: {{timestamp}}
      Project config root: {{PROJECT_EDISON_DIR}}
      
      To modify, edit the source template or configuration.
    -->
  # DRY (Don't Repeat Yourself) detection configuration
  dryDetection:
    minShingles: 2       # Minimum shingles for duplication detection (default from EDISON_DRY_MIN_SHINGLES)
    shingleSize: 12      # Size of shingles for similarity comparison (k parameter)
    minSimilarity: 0.8   # Minimum Jaccard similarity for guideline duplication detection
    cliThreshold: 0.3    # Default duplication threshold for CLI audit command

  # Workflow loop instructions for orchestrators
  workflowLoop:
    command: "scripts/session next <session-id>"
    frequency: "Before EVERY action"
    readOrder:
      - "1. üìã APPLICABLE RULES (read FIRST)"
      - "2. üéØ RECOMMENDED ACTIONS (read AFTER rules)"
      - "3. ü§ñ DELEGATION HINT (follow priority chain)"
      - "4. üîç VALIDATORS (auto-detected from git diff)"

  # Metadata inference for validators
  metadata:
    defaults:
      model: "codex"
      alwaysRun: false
      blocksOnFail: false
      triggers:
        - "*"

    # Search paths for validator definitions (ordered by priority)
    searchPaths:
      - "{project_dir}/_generated/validators/{validator_id}.md"
      - "{project_dir}/validators/specialized/{validator_id}.md"
      - "{repo_root}/.edison/core/validators/specialized/{validator_id}.md"
      - "{packs_dir}/{pack}/validators/{validator_id}.md"
