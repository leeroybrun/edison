# TDD Configuration
# Test-Driven Development enforcement settings

tdd:
  # TDD policy levels used by composed prompts/constitutions.
  # - strict: enforce test-first, require evidence, and strongly prefer full verification.
  # - warn: enforce TDD but allow pragmatic judgment; reject only on clear violations.
  # - off: do not include TDD enforcement guidance in composed prompts.
  enforcement: warn

  enforceRedGreenRefactor: true
  requireEvidence: true
  hmacValidation: false

  # Whether prompts/constitutions require explicit git commit markers (e.g. [RED]/[GREEN]/[REFACTOR]).
  # This is a *prompt-level* enforcement knob; it does not change runtime behavior.
  enforceCommitMarkers: true

  # Scan these file globs for forbidden focus/skip tokens before allowing `task ready`.
  # Globs are relative to the project root and any active session worktree.
  testFileGlobs:
    - "**/*.test.*"
    - "**/*.spec.*"
    - "**/__tests__/**/*"

  # Substrings (case-sensitive) that must never appear in committed test sources.
  # Keep minimal: enforcement logic can evolve, but defaults must catch common footguns.
  blockedTestTokens:
    - ".only"

  # Optional per-project TDD verification script (e.g., coverage thresholds).
  # When present and executable, `edison task done` must run it and fail if it exits non-zero.
  verificationScript: "scripts/tdd-verification.sh"

  # Evidence HMAC signing/verification is enabled when this env var is set.
  hmacKeyEnvVar: "project_EVIDENCE_HMAC_KEY"
