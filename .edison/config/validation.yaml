# Edison project-specific QA overrides.
#
# This file intentionally contains Edison-repo conventions (e.g. a full-suite
# session-close requirement). Downstream projects using Edison should define
# their own validation presets/evidence requirements here as needed.

validation:
  # Fast preset used by default for per-task iteration in the Edison repo.
  defaultPreset: fast

  # Deep preset used for session-close verification in the Edison repo.
  presets:
    fast:
      name: fast
      description: "Fast per-task validation for iteration (Edison repo)"
      validators:
        - global-codex
        - global-claude
        - global-coderabbit
      # required_evidence is intentionally omitted so baseline evidence applies.
      blocking_validators:
        - global-codex
        - global-claude

    deep:
      name: deep
      description: "Deep validation required before session close (Edison repo)"
      validators:
        - global-codex
        - global-claude
        - security
        - performance
        - global-coderabbit
      required_evidence:
        - command-type-check.txt
        - command-test-full.txt
        - command-build.txt
      blocking_validators:
        - global-codex
        - global-claude
        - security
        - performance

  validators:
    global-codex:
      timeout: 900

    # Run critical validators with Claude CLI by default for reliability.
    security:
      engine: claude-cli
      timeout: 300

    performance:
      engine: claude-cli
      timeout: 300

    # The global validator prompt is intentionally large (constitution + checklist + stack overlays).
    # 300s is frequently too low for remote model execution; avoid false negatives due to timeouts.
    global-claude:
      timeout: 900

    global-coderabbit:
      name: "CodeRabbit AI Review (Global)"
      engine: coderabbit-cli
      fallback_engine: pal-mcp
      prompt: "_generated/validators/critical/coderabbit.md"
      wave: global
      always_run: false
      blocking: false
      timeout: 600
      context7_required: false
      context7_packages: []
      triggers: []
      focus: []

    # Edison repo default: keep the global validator set small and reliable.
    # Other projects can re-enable these in their own validation.yaml if desired.
    global-gemini:
      enabled: false

    global-auggie:
      enabled: false

  # Session-close evidence requirement for the Edison repo.
  sessionClose:
    preset: deep

  # Per-task baseline evidence should be high-signal but fast enough to run often.
  # Deep validation (type-check, full tests, build) is reserved for session close.
  evidence:
    requiredFiles:
      - command-test.txt
