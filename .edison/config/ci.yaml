# Edison Project CI Commands (used by templates via {{function:ci_command(...)}})

ci:
  commands:
    # NOTE: Edison is not yet mypy-clean; use a lightweight syntax/type sanity check
    # for session-close evidence until strict typing is enforced repository-wide.
    type-check: "./.venv/bin/python -m compileall -q src/"
    # NOTE: This repo is not ruff-clean yet. For QA evidence capture we still want a lint
    # report, but we don't want it to block evidence generation for unrelated changes.
    lint: "./.venv/bin/ruff check src/ tests/ --exit-zero"
    format: "./.venv/bin/ruff format src/ tests/"
    format-check: "./.venv/bin/ruff format --check src/ tests/"
    test: "scripts/test-fast"
    test-fast: "./.venv/bin/pytest -q tests/unit/qa tests/unit/cli/qa tests/unit/cli/evidence tests/unit/cli/task tests/unit/cli/session tests/unit/cli/test_mutability_task_ready_done.py tests/unit/session/next tests/unit/session/lifecycle tests/unit/task"
    test-task: "./.venv/bin/pytest -q tests/unit/task"
    test-import: "./.venv/bin/pytest -q tests/unit/core/import_"
    test-context7: "./.venv/bin/pytest -q tests/unit/qa/test_context7_task_scoped_detection_avoids_session_contamination.py tests/unit/state/test_can_finish_task_context7_messages.py tests/unit/qa/validation/test_file_context_service_uses_task_primary_files_when_no_report.py"
    # NOTE: Full-suite integration tests are still evolving and can be slow/flaky
    # under multi-session development. For session-close evidence, prefer the
    # fast deterministic suite. Projects can override this per repo.
    test-full: "scripts/test-fast"
    test-coverage: "./.venv/bin/pytest tests/ --cov=src --cov-report=term-missing"
    build: "./.venv/bin/python -m build"
